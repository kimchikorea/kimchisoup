<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" layout:decorator="layout/public">
<head>
  <title>Sign Up</title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"
      th:src="@{/webjars/jquery/1.11.3/jquery.min.js}"></script>
  <link href="http://cdn.jsdelivr.net/webjars/bootstrap/3.3.4/css/bootstrap.min.css" 
        th:href="@{/webjars/bootstrap/3.3.4/css/bootstrap.min.css}" rel="stylesheet" media="screen" />
  <link rel="stylesheet" type="text/css" media="screen" href="../../css/common.css" th:href="@{/css/common.css}" />
  
  <script type="text/javascript" language="javascript">
			

		var duplChk = 0;
		$("#2chk").click(function() {
			$("#userid").focus();
	    });
		
		
		//idck 버튼을 클릭했을 때 
	    $("#chk").click(function() {
	    	
	    	alert($("#uid").val());
	    	//userid 를 param.
	        var userid =  $("#uid").val(); 
	    	
	    	obj.uid = $("#uid").val();
	    	obj.uemail = $("#uemail").val();
	    	obj.upw = $("#upw").val();

	    	var jsonData = JSON.stringify(obj);
	        
	        $.ajax({
	            async: false,
	            type : 'POST',
	            data : jsonData,
	            url : "/idCheck",
	            dataType : "json",
	            contentType: "application/json; charset=UTF-8",
	            success : function(data) {
	            	console.log(data.cnt);
	                if (data.cnt > 0) {

	                    alert("아이디가 존재합니다. 다른 아이디를 입력해주세요.");
	                    //아이디가 존제할 경우 빨깡으로 , 아니면 파랑으로 처리하는 디자인
	                    //$("#divInputId").addClass("has-error")
	                    //$("#divInputId").removeClass("has-success")
	                    $("#userid").focus();
	                    
	                
	                } else {
	                    alert("회원가입 되었습니다. ID : " + $("#uid").val());
	                    window.location.href = "/";
	                    
	                }
	            },
	            error : function(error) {
	                
	                alert("error : " + error);
	            }
	        }); 
	    });
		

	});

</script>
  
</head>
<body>
             
<div id="page-wrapper" layout:fragment="content">  
  <div class="container" style="margin-top: 100px;">
    <div class="row">
      <div class="col-md-4 col-md-offset-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Please sign up</h3>
          </div>
          <div class="panel-body">
           <form th:action="@{/member}" method="post" commandName="member"> 
              <fieldset>
                <div class="form-group">
                  <input type="text" name="uid" id="uid" class="form-control" placeholder="User Id" required="required" autofocus="autofocus" /> 

                </div>
                <div class="form-group">
                  <input type="email" name="uemail" id="uemail" class="form-control" placeholder="E-Mail" required="required" autofocus="autofocus" />
                </div>
                <div class="form-group">
                  <input type="password" name="upw" id="upw" class="form-control" placeholder="Password" required="required" />
                </div>
                <button class="btn btn-lg btn-primary btn-block"  id="chk">Registration</button>    
              </fieldset>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


</body>
</html>